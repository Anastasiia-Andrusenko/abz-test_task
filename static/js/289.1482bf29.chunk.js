"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[289],{285:(e,t,s)=>{s.d(t,{A:()=>n});const a="Button_btn__W1TTO";var r=s(579);const n=e=>{let{text:t,type:s,onClick:n,disabled:c}=e;return(0,r.jsx)("button",{className:a,type:s,onClick:n,disabled:c,children:t})}},289:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(43);const r={usersList:"Users_usersList__dUp72",filter:"Users_filter__uT5id","main-button":"Users_main-button__KDna-","hidden-title":"Users_hidden-title__8Crw2","modal-open":"Users_modal-open__j-MkQ",section:"Users_section__8LAkI",container:"Users_container__TvdBD",title:"Users_title__6hk01",userCard:"Users_userCard__p5cxK",cardContainer:"Users_cardContainer__ikUak",avatar:"Users_avatar__1NQNV",name:"Users_name__WxBDd",textWrapper:"Users_textWrapper__58ct8",position:"Users_position__EEFbM",email:"Users_email__+5E6X",phone:"Users_phone__IiTc4",btnWrapper:"Users_btnWrapper__-xF-5",btn:"Users_btn__p5Y3Z",loader:"Users_loader__VVnNh",spin:"Users_spin__rxnXw"};var n=s(866),c=s(285),o=s(608),i=s(466);const l=e=>{const t=(""+e).replace(/\D/g,"").match(/^(\d{2})(\d{3})(\d{3})(\d{2})(\d{2})$/);if(t)return"+".concat(t[1]," (").concat(t[2],") ").concat(t[3]," ").concat(t[4]," ").concat(t[5])};const d=s.p+"static/media/avatar.fb98cf13a87225efe558669bdc541ac7.svg";var p=s(579);const _=e=>{let{src:t,alt:s}=e;const[n,c]=(0,a.useState)(t);return(0,p.jsx)("img",{className:r.avatar,src:n,alt:s,onError:()=>{c(d)}})},h=e=>{let{update:t}=e;const[s,d]=(0,a.useState)([]),[h,m]=(0,a.useState)(1),[u,x]=(0,a.useState)(!0),[g,w]=(0,a.useState)(null),[U,N]=(0,a.useState)(!1),j=async e=>{N(!0);try{const t=await(0,n.hU)(e);d((e=>[...e,...t.users])),x(t.page<t.total_pages)}catch(g){w("Failed to fetch users. Please try again later."),console.log(g)}finally{N(!1)}};return(0,a.useEffect)((()=>{d([]),m(1),j(1)}),[t]),(0,a.useEffect)((()=>{h>1&&j(h)}),[h]),(0,p.jsxs)("section",{className:r.section,children:[(0,p.jsxs)("div",{className:r.container,children:[(0,p.jsx)("h2",{className:r.title,children:"Working with GET request"}),g&&(0,p.jsx)("p",{className:r.error,children:g}),(0,p.jsx)("ul",{className:r.usersList,children:s.map(((e,t)=>(0,p.jsx)("li",{className:r.userCard,children:(0,p.jsxs)("div",{className:r.cardContainer,children:[(0,p.jsx)(_,{src:e.photo,alt:e.name}),(0,p.jsx)("div",{className:r.textWrapper,children:(0,p.jsx)("p",{className:r.name,"data-tooltip":e.name,children:(0,i.E)(e.name)})}),(0,p.jsx)("div",{className:r.textWrapper,children:(0,p.jsx)("p",{className:r.position,"data-tooltip":e.position,children:(0,i.E)(e.position)})}),(0,p.jsx)("div",{className:r.textWrapper,children:(0,p.jsx)("p",{className:r.email,"data-tooltip":e.email,children:(0,i.E)(e.email)})}),(0,p.jsx)("div",{className:r.textWrapper,children:(0,p.jsx)("p",{className:r.phone,"data-tooltip":e.phone,children:l(e.phone)})})]})},"".concat(e.id,"+").concat(t))))}),U&&(0,p.jsx)("img",{src:o.A,alt:"loading...",loading:"lazy",className:r.loader})]}),u&&(0,p.jsx)("div",{onClick:()=>m(h+1),className:r.btnWrapper,children:(0,p.jsx)(c.A,{text:"Show more",type:"button",className:r.btn})})]})}},866:(e,t,s)=>{s.d(t,{DY:()=>i,hU:()=>c,zB:()=>o});var a=s(213);const r="https://frontend-test-assignment-api.abz.agency/api/v1",n=async()=>{try{return(await a.A.get("".concat(r,"/token"))).data.token}catch(e){throw console.error("error fetching token:",e),e}},c=async e=>{try{const t=await n(),s=await a.A.get("".concat(r,"/users"),{params:{page:e,count:6},headers:{Token:t}}),c=s.data.users.sort(((e,t)=>new Date(t.registration_timestamp)-new Date(e.registration_timestamp)));return{...s.data,users:c}}catch(t){throw console.error("Error fetching users:",t),t}},o=async()=>{try{return(await a.A.get("".concat(r,"/positions"))).data}catch(e){throw console.log("Error fetching positions:",e),e}},i=async e=>{try{const t=await n();return(await a.A.post("".concat(r,"/users"),e,{headers:{"Content-Type":"multipart/form-data",Token:t}})).data}catch(t){throw console.log("Error register user:",t),t}}},466:(e,t,s)=>{s.d(t,{E:()=>r,V:()=>a});const a=e=>{const t=window.innerWidth>=768?30:22;return e.length<=t?e:e.substring(0,t)+"..."},r=e=>{const t=window.innerWidth>=1024?30:35;return e.length<=t?e:e.substring(0,t)+"..."}}}]);
//# sourceMappingURL=289.1482bf29.chunk.js.map